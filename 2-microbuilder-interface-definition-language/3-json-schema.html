<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <title>Microbuilder</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Customizable and extensible toolkit for transforming lightweight markup languages to various types of output formats, written in Scala" />
    <meta name="keywords" content="scala, text, markup, markdown, restructuredtext, parser, transformer, html, template engine, site generation, open-source" />

    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">

</head>

<body data-spy="scroll" data-target=".toc" data-offset="200">


<div class="container">

    <!-- Docs nav
    ================================================== -->
    <div class="row">
        <div class="span4 toc" >

            <ul class="nav nav-list affix">
                <div class="toc">
                  <ul>
                    <li>
                      <p><a class="toc level1" href="../1-overview.html">Overview</a></p>
                      <ul>
                        <li><a class="toc level2" href="../1-overview.html#motive">Motive</a></li>
                        <li><a class="toc level2" href="../1-overview.html#how-microbuilder-works">How Microbuilder works</a></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">Microbuilder Interface Definition Language</p>
                      <ul>
                        <li><a class="toc level2" href="1-concepts.html">Concepts</a></li>
                        <li>
                          <p><a class="toc level2" href="2-interface-definition.html">Interface definition</a></p>
                          <ul>
                            <li><a class="toc level3" href="2-interface-definition.html#package-and-directory-layout">Package and directory layout</a></li>
                            <li><a class="toc level3" href="2-interface-definition.html#interfaces-and-methods">Interfaces and methods</a></li>
                          </ul>
                        </li>
                        <li>
                          <p class="toc level2 active">JSON schema</p>
                          <ul>
                            <li><a class="toc level3" href="#request-content-json-schema">Request content JSON schema</a></li>
                            <li><a class="toc level3" href="#response-content-json-schema">Response content JSON schema</a></li>
                            <li>
                              <p><a class="toc level3" href="#built-in-types-for-json-schema">Built-in types for JSON schema</a></p>
                              <ul>
                                <li><a class="toc level4" href="#primary-types">Primary types</a></li>
                                <li><a class="toc level4" href="#array-types">Array types</a></li>
                              </ul>
                            </li>
                            <li><a class="toc level3" href="#custom-class-types">Custom class types</a></li>
                          </ul>
                        </li>
                        <li>
                          <p><a class="toc level2" href="4-annotations.html">Annotations</a></p>
                          <ul>
                            <li><a class="toc level3" href="4-annotations.html#id-1"><code>@:structuralFailure</code></a></li>
                            <li><a class="toc level3" href="4-annotations.html#1"><code>@:nativeGen</code></a></li>
                            <li><a class="toc level3" href="4-annotations.html#2"><code>@:route</code></a></li>
                            <li><a class="toc level3" href="4-annotations.html#3"><code>@:requestContentType</code></a></li>
                            <li><a class="toc level3" href="4-annotations.html#4"><code>@:responseContentType</code></a></li>
                            <li><a class="toc level3" href="4-annotations.html#5"><code>@:requestHeader</code></a></li>
                            <li><a class="toc level3" href="4-annotations.html#6"><code>@:final</code></a></li>
                            <li><a class="toc level3" href="4-annotations.html#7"><code>@:transient</code></a></li>
                          </ul>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">Client-side SDKs</p>
                      <ul>
                        <li>
                          <p><a class="toc level2" href="../3-client-side-sdks/1-for-scala-client.html">For Scala client</a></p>
                          <ul>
                            <li><a class="toc level3" href="../3-client-side-sdks/1-for-scala-client.html#requirement">Requirement</a></li>
                            <li>
                              <p><a class="toc level3" href="../3-client-side-sdks/1-for-scala-client.html#create-the-sdk">Create the SDK</a></p>
                              <ul>
                                <li><a class="toc level4" href="../3-client-side-sdks/1-for-scala-client.html#sbt-configuration-for-sdk">Sbt configuration for SDK</a></li>
                                <li><a class="toc level4" href="../3-client-side-sdks/1-for-scala-client.html#midl-api-definition">MIDL API definition</a></li>
                                <li><a class="toc level4" href="../3-client-side-sdks/1-for-scala-client.html#midl-json-schema-definition">MIDL JSON schema definition</a></li>
                              </ul>
                            </li>
                            <li><a class="toc level3" href="../3-client-side-sdks/1-for-scala-client.html#publish-the-sdk">Publish the SDK</a></li>
                            <li><a class="toc level3" href="../3-client-side-sdks/1-for-scala-client.html#dependency-settings-for-client-application">Dependency settings for Client application</a></li>
                            <li><a class="toc level3" href="../3-client-side-sdks/1-for-scala-client.html#use-sdk">Use SDK</a></li>
                          </ul>
                        </li>
                        <li><a class="toc level2" href="../3-client-side-sdks/2-for-javascript-client.html">For JavaScript client</a></li>
                        <li><a class="toc level2" href="../3-client-side-sdks/3-for-other-language-client.html">For other language client</a></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">Server-side stubs</p>
                      <ul>
                        <li><a class="toc level2" href="../4-server-side-stubs/1-for-scala-server.html">For Scala server</a></li>
                        <li><a class="toc level2" href="../4-server-side-stubs/2-for-other-language-server.html">For other language server</a></li>
                      </ul>
                    </li>
                    <li>
                      <p class="toc level1">Generating Documentation</p>
                      <ul>
                        <li><a class="toc level2" href="../5-generating-documentation/1-haxedoc.html">Haxedoc</a></li>
                        <li><a class="toc level2" href="../5-generating-documentation/2-swagger-ui.html">Swagger UI</a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
            </ul>

        </div>

        <div class="span8" id="top">

            
            <h1 id="json-schema" class="title">JSON schema</h1>
            <p>In MIDL, we use classes to describe the JSON schema for request content or response content.
            Client-side SDKs and server-side stubs will convert class instances from/to JSON.</p>
            
            <h2 id="request-content-json-schema" class="section">Request content JSON schema</h2>
            <p>A MIDL method that has a <a href="4-annotations.html#3"><code>@:requestContentType</code></a>
            describes an endpoint that requires a request content body.
            For these method, the last parameter will be send to server as request content body,
            and the type of the last parameter references to a JSON schema for the request content body.</p>
            <pre><code>@:nativeGen
interface IMyService {
  @:requestContentType(&quot;text/json&quot;)
  @:route(&quot;PUT&quot;, &quot;users/{userId}&quot;)
  function setProfile(userId:String, contentBody:RequestType):Future&lt;Void&gt;;
}</code></pre>
            <p>In the above code block, <code>RequestType</code> must be a type that describes JSON schema for request content body.</p>
            
            <h2 id="response-content-json-schema" class="section">Response content JSON schema</h2>
            <p>The return type of a MIDL method must be <code>jsonStream.rpc.Future&lt;ResponseType&gt;</code>,
            where <code>ResponseType</code> is the data structure of JSON for HTTP response.</p>
            <pre><code>@:nativeGen
interface IMyService {
  @:responseContentType(&quot;text/json&quot;)
  @:route(&quot;PUT&quot;, &quot;users/{userId}&quot;)
  function getProfile(userId:String):Future&lt;ResponseType&gt;;
}</code></pre>
            <p>In the above code block, <code>RequestType</code> must be a type that describes JSON schema for response content body.</p>
            
            <h2 id="built-in-types-for-json-schema" class="section">Built-in types for JSON schema</h2>
            
            <h3 id="primary-types" class="section">Primary types</h3>
            <p>MIDL reuses some standard types in Haxe language as primary types of JSON schema.</p>
            <ul>
              <li><a href="http://api.haxe.org/Int.html">Int</a> and <a href="http://api.haxe.org/Int.html">Float</a> correspond to JavaScript <code>Number</code> literal, e.g. <code>1.2</code>, <code>-3.4</code>, <code>3.2349E-13</code></li>
            </ul>
            <ul>
              <li><a href="http://api.haxe.org/String.html">String</a> corresponds to JavaScript <code>String</code> literal, e.g. <code>&quot;string value&quot;</code>.</li>
            </ul>
            <ul>
              <li><a href="http://api.haxe.org/String.html">Bool</a> corresponds to JavaScript <code>Boolean</code> literal, which could be <code>false</code> or <code>true</code>.</li>
            </ul>
            
            <h3 id="array-types" class="section">Array types</h3>
            <p>In MIDL, <a href="http://api.haxe.org/haxe/ds/Vector.html">haxe.ds.Vector</a> corresponds to JavaScript <code>Array</code> literal,
            and the type parameter of <code>Vector</code> is the element type.</p>
            <p>For example, <code>Vector&lt;Int&gt;</code> accepts JSON like <code>[2, 4, 5]</code>, and <code>Vector&lt;Bool&gt;</code> accepts JSON like <code>[false, true, true]</code>.</p>
            
            <h2 id="custom-class-types" class="section">Custom class types</h2>
            <p>In MIDL, a <code>class</code> defines the schema of a JSON object literal.</p>
            <p>For example,</p>
            <pre><code>// This file is at src/haxe/userSdk/model/Models.hx
package userSdk.model;

@:final class UserProfile {
  public function new() {}
  public var name:String;
  public var email:String;
  public var age:Int;
}</code></pre>
            <p>This class accepts JSON like <code>{ &quot;name&quot;: &quot;Zhang San&quot;, &quot;email&quot;: &quot;zs@host.com&quot;, age: 18 }</code>.</p>
            <p>Note that you must not omit the constructor <code>public function new() {}</code>,
            otherwise client-side SDKs and server-side stubs will not be able to convert a <code>UserProfile</code> from/to JSON.</p>

        </div>
    </div>

</div>

</body></html>
